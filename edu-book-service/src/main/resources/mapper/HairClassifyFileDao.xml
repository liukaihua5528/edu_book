<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edu.book.infrastructure.repositoryImpl.dao.hair.HairClassifyFileDao">

    <!--fun queryListByClassifyUid(param: PageQueryClassifyDetailParam): List<HairClassifyFilePo>-->
    <select id="queryListByClassifyUid" parameterType="com.edu.book.domain.hair.dto.PageQueryClassifyDetailParam"
        resultType="com.edu.book.infrastructure.po.hair.HairClassifyFilePo">
        SELECT
            file.c_uid AS uid,
            file.c_classify_uid AS classifyUid,
            file.c_file_path AS filePath,
            file.c_file_key AS fileKey
        FROM
            t_hair_classify_file file
        JOIN t_upload_file upload ON file.c_file_key = upload.c_file_key AND upload.c_is_deleted = 0
        WHERE
            file.c_classify_uid = #{classifyUid}
        AND file.c_is_deleted = 0
        ORDER BY upload.c_create_time DESC
        <bind name="key_offset" value="(page-1) * pageSize"/>
        <if test="page != null and page >= 0 and pageSize != null and pageSize >= 0">
            LIMIT #{key_offset},#{pageSize}
        </if>
    </select>

</mapper>
